"use strict";var _createClass=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),_classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},StateMachine;!function(t){function e(t){return"undefined"==typeof t}var n=function(){function t(e,n){_classCallCheck(this,t),this._sm=e,this.name=n,this._events={},this._enter=[],this._exit=[]}return _createClass(t,{_makeEventHandler:{value:function(t){var e=this;if("function"==typeof t)return t;if("string"==typeof t)return function(){return e._sm.go(t)};if("undefined"==typeof t)return function(){};throw new Error("invalid event handler")}},on:{value:function(t,e){var n=this._events,r=(this._sm,this._makeEventHandler(e));switch(t){case"enter":this._enter.push(r);break;case"exit":this._exit.push(r);break;default:n.hasOwnProperty(t)||(n[t]=[]),n[t].push(r)}return this}},emit:{value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];var i,a=this._sm,s=a.options.verbose,o=a.options.name,c=a.options.logExceptions,h=this;if(null===h)throw new Error("the state machine has not been initialized");if(i=h._events,!i.hasOwnProperty(t))throw new Error(t+" event not defined for "+h.name+" state");if(s&&console.log(o+": "+h.name+"."+t),c)try{i[t].forEach(function(t){return t.apply(a,n)})}catch(u){throw console.log(o+": "+h.name+" ! "+u.message),u}else i[t].forEach(function(t){return t.apply(a,n)})}}}),t}();t.State=n;var r=function(){function t(n){_classCallCheck(this,t),this._states={},this.current=null,e(n)&&(n={}),e(n.verbose)&&(n.verbose=!1),e(n.name)&&(n.name="StateMachine"),e(n.logExceptions)&&(n.logExceptions=!1),this.options=n}return _createClass(t,{init:{value:function(t){var n=this._states;if(e(n[t]))throw new Error(t+" state is not defined");this.current=n[t]}},state:{value:function(t){var e=this._states;return e.hasOwnProperty(t)||(e[t]=new n(this,t)),e[t]}},emit:{value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;e>r;r++)n[r-1]=arguments[r];var i=this.current;if(null===i)throw new Error("the state machine has not been initialized");i.emit.apply(i,arguments)}},go:{value:function(t){var n=this,r=this._states[t],i=this.current,a=function(t){return t.call(n)};if(e(r))throw new Error(t+" state does not exist");i.name!==t&&(this.options.verbose&&console.log(this.options.name+": "+i.name+" -> "+t),i._exit.forEach(a),this.current=r,r._enter.forEach(a))}}}),t}();t.StateMachine=r}(StateMachine||(StateMachine={}));
//# sourceMappingURL=StateMachine.js.map
